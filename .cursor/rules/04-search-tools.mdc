---
description: Force usage of ast-grep for code-aware structure searches.
globs:
  - "**/*.{ts,tsx,js,jsx,py,go,rs,java,c,cpp}"
alwaysApply: true
---

# Structural Search Strategy

You **MUST** use `ast-grep` (command `sg` or `ast-grep`) when the user asks to find code patterns, class definitions, or complex structural references. Do not use standard regex `grep` for these tasks.

## Execution Protocol

1.  **Verify**: First, verify `ast-grep` is installed by running `ast-grep --version` in the terminal.
2.  **Execute**: Run the search patterns via the **Terminal** pane.
3.  **Path**: If `ast-grep` is not in the path, try invoking it explicitly at `/opt/homebrew/bin/ast-grep`.

## Pattern Reference

Use the following flag combinations:

- Basic: `ast-grep --pattern 'pattern' --json` (Use JSON output for easier parsing)
- Function: `ast-grep --pattern 'function $NAME($ARGS) { $$$ }'`
- Class: `ast-grep --pattern 'class $NAME { $$$ }'`

## Fallback

Only if `ast-grep` fails to execute or returns no results, fall back to `ripgrep` (rg).
